# ุชฺฉูู: ุงุตูุงุญ ููุทู ุฐุฎุฑูโุณุงุฒ - item_id Based

## โ ฺฉุงุฑ ุงูุฌุงู ุดุฏ

ููุทู ุฐุฎุฑูโุณุงุฒ ูุญุตููุงุช ุงุฒ ุจุงุฑุงู **ุชุบุฑ ฺฉุฑุฏ**:

### ๐ ููุทู ูุจู:
```
ุงฺฏุฑ (license_id + item_id) ููุฌูุฏ โ ุจูโุฑูุฒุฑุณุงู
ูฺฏุฑูู โ ุฏุฑุฌ
```

### ๐ ููุทู ุฌุฏุฏ:
```
ุงฺฏุฑ item_id ููุฌูุฏ (ุจุฏูู ุฏุฑ ูุธุฑ ฺฏุฑ license) โ ุจูโุฑูุฒุฑุณุงู
ูฺฏุฑูู โ ุฏุฑุฌ
```

## ๐ฏ ุชุฃุซุฑ

### ูุซุงู 1: License ูุชูุงูุชุ item_id ฺฉุณุงู
```
Scenario:
โโ License 1 โ ITEM-001 (ููุช: 100000)
โโ License 2 โ ITEM-001 (ููุช: 150000)

ูุจู:
โโ Product 1: license=1, item_id=ITEM-001, price=100000
โโ Product 2: license=2, item_id=ITEM-001, price=150000 โ (ุชฺฉุฑุงุฑ)

ุจุนุฏ:
โโ Product: license=2, item_id=ITEM-001, price=150000 โ (ฺฉุชุง)
```

### ูุซุงู 2: item_id ุฌุฏุฏ
```
License 1 โ ITEM-002

ูุจู: Product ุงุฌุงุฏ (ุงฺฏุฑ ูุจุงุดุฏ)
ุจุนุฏ: Product ุงุฌุงุฏ (ุงฺฏุฑ ูุจุงุดุฏ) โ (ฺฉุณุงู)
```

## ๐ง ฺฉุฏ ุงุตูุงุญ ุดุฏู

**ูุงู:** `app/Jobs/Tantooo/ProcessTantoooSyncRequest.php`

**ูุชุฏ:** `saveBaranProductsToDatabase()`

**ุชุบุฑ ฺฉูุฏ:**
```php
// ูุจู:
// $product = Product::where('license_id', $license->id)
//     ->where('item_id', $itemId)
//     ->first();

// ุจุนุฏ:
$product = Product::where('item_id', $itemId)->first();  // โจ
```

## ๐ ูุชุงุฌ

| ุฌูุจู | ุชูุถุญ |
|------|--------|
| **ุฌุณุชุฌู** | ููุท ุจุฑ ุงุณุงุณ `item_id` |
| **License ุชุบุฑ** | license_id ุจุฑุง ุฑฺฉูุฑุฏ ููุฌูุฏ ูู ุจูโุฑูุฒุฑุณุงู ูโุดูุฏ |
| **ูุญุตููุงุช ูุดุชุฑฺฉ** | ฺฉ ูุญุตูู ุจุฑุง ฺูุฏ licenses |
| **ุตุฑููโุฌู** | ฺฉูุชุฑ ุชฺฉุฑุงุฑ ุฏุฑ ุฏุชุงุจุณ |

## ๐ ูุงฺฏโูุง ุฌุฏุฏ

```
[DEBUG] ูุญุตูู ุจูโุฑูุฒุฑุณุงู ุดุฏ
{
    license_id: 2,
    item_id: 'ITEM-001',
    action: 'updated',
    old_license_id: 1  โจ ุจุฑุง ุฑุฏุงุจ ุชุบุฑ
}
```

## ๐ ูุงูโูุง ุงุตูุงุญ ุดุฏู

1. โ `app/Jobs/Tantooo/ProcessTantoooSyncRequest.php`
   - ููุทู ุฌุณุชุฌู ุงุตูุงุญ ุดุฏู
   - license_id ุจูโุฑูุฒุฑุณุงู ุงุถุงูู ุดุฏู
   - ูุงฺฏโูุง ุฌุฏุฏ ุงุถุงูู ุดุฏู

2. โ `test_save_logic_item_id_based.php` (ุฌุฏุฏ)
   - ุชุณุช ู ูุซุงูโูุง ุนูู

3. โ `ITEM_ID_BASED_LOGIC.md` (ุฌุฏุฏ)
   - ูุณุชูุฏุงุช ุชูุตู

## ๐ ูุฒุงุง

โ **ฺฉูพุงุฑฺฺฏ**: ฺฉ ูุญุตูู ุจุฑุง ุชูุงู licenses  
โ **ูุฑฺฉุฒุช**: ุชุบุฑุงุช ููุช ุจุฑุง ููู ููุนฺฉุณ  
โ **ุตุฑููโุฌู**: ฺฉูุชุฑ ุฑฺฉูุฑุฏ ุชฺฉุฑุงุฑ  
โ **ุงุดุชุฑุงฺฉ**: ูุญุตููุงุช ูุดุชุฑฺฉ  

## โ๏ธ ูฺฉุงุช

1. **License ุชุบุฑ ูโุงุจุฏ**: ุขุฎุฑู license ุจุฑูุฏู
2. **last_sync_at**: ุจุฑุง ูุฑ ุจูโุฑูุฒุฑุณุงู ุชูุธู ูโุดูุฏ
3. **item_id ููุญุตุฑ**: ุฏุฑ ุฏุชุงุจุณ ููุท ฺฉ ุจุงุฑ
4. **Cascading**: ุชุบุฑุงุช ุจุฑุง ุชูุงู licenses

## ๐งช ุชุณุช

```bash
php test_save_logic_item_id_based.php
```

## โ ูุถุนุช

```
โ ููุทู ุฌุณุชุฌู ุงุตูุงุญ ุดุฏ
โ license_id ุงุถุงูู ุดุฏ
โ ูุงฺฏโูุง ุฌุฏุฏ ุงุถุงูู ุดุฏูุฏ
โ ุชุณุชโูุง ุงุฌุงุฏ ุดุฏูุฏ
โ ูุณุชูุฏุงุช ููุดุชู ุดุฏูุฏ
โ ุจุฏูู ุฎุทุง syntax
```

---

**ุชุงุฑุฎ:** ฑธ ููุฑ ฑดฐด  
**ูุถุนุช:** โ ุชฺฉูู ุดุฏู
