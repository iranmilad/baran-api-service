<?php

echo "=== ØªØ³Øª ÙØ±Ø¢ÛŒÙ†Ø¯ Ø«Ø¨Øª Ùˆ Ø§Ø³ØªØ¹Ù„Ø§Ù… Ù…Ø´ØªØ±ÛŒ Ø¯Ø± ProcessInvoice ===\n";

// Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ Ø³Ù†Ø§Ø±ÛŒÙˆÙ‡Ø§ÛŒ Ù…Ø®ØªÙ„Ù Ø¨Ø±Ø§ÛŒ Ø¨Ø±Ø±Ø³ÛŒ Ù…Ù†Ø·Ù‚

echo "\nðŸ“‹ Ø¨Ø±Ø±Ø³ÛŒ Ù…Ù†Ø·Ù‚ ÙØ±Ø¢ÛŒÙ†Ø¯:\n";

// Ø³Ù†Ø§Ø±ÛŒÙˆ 1: Ù…Ø´ØªØ±ÛŒ Ù…ÙˆØ¬ÙˆØ¯ Ø§Ø³Øª
echo "\n1. Ø³Ù†Ø§Ø±ÛŒÙˆ: Ù…Ø´ØªØ±ÛŒ Ù…ÙˆØ¬ÙˆØ¯ Ø§Ø³Øª\n";
echo "   âœ… GetCustomerByCode Ù…ÙˆÙÙ‚\n";
echo "   âœ… customerResult Ø´Ø§Ù…Ù„ CustomerID\n";
echo "   âœ… customerExists = true\n";
echo "   âœ… ÙØ±Ø¢ÛŒÙ†Ø¯ Ø«Ø¨Øª Ù…Ø´ØªØ±ÛŒ skip Ù…ÛŒâ€ŒØ´ÙˆØ¯\n";
echo "   âœ… Ù…Ø³ØªÙ‚ÛŒÙ…Ø§Ù‹ Ø¨Ù‡ Ø«Ø¨Øª ÙØ§Ú©ØªÙˆØ± Ù…ÛŒâ€ŒØ±ÙˆØ¯\n";

// Ø³Ù†Ø§Ø±ÛŒÙˆ 2: Ù…Ø´ØªØ±ÛŒ Ù…ÙˆØ¬ÙˆØ¯ Ù†ÛŒØ³Øª (Ù¾Ø§Ø³Ø® Ù…ÙˆÙÙ‚ ÙˆÙ„ÛŒ Ù†ØªÛŒØ¬Ù‡ null)
echo "\n2. Ø³Ù†Ø§Ø±ÛŒÙˆ: Ù…Ø´ØªØ±ÛŒ Ù…ÙˆØ¬ÙˆØ¯ Ù†ÛŒØ³Øª (Ù¾Ø§Ø³Ø® Ù…ÙˆÙÙ‚ØŒ Ù†ØªÛŒØ¬Ù‡ null)\n";
echo "   âœ… GetCustomerByCode Ù…ÙˆÙÙ‚\n";
echo "   âœ… customerResult = null (parseCustomerResponse)\n";
echo "   âœ… customerExists = false\n";
echo "   âž¡ï¸  ÙˆØ§Ø±Ø¯ ÙØ±Ø¢ÛŒÙ†Ø¯ Ø«Ø¨Øª Ù…Ø´ØªØ±ÛŒ Ù…ÛŒâ€ŒØ´ÙˆØ¯\n";
echo "   âœ… SaveCustomer Ø§Ø¬Ø±Ø§ Ù…ÛŒâ€ŒØ´ÙˆØ¯\n";
echo "   âœ… sleep(10) Ø¨Ø±Ø§ÛŒ Ø§Ù†ØªØ¸Ø§Ø±\n";
echo "   âœ… GetCustomerByCode Ù…Ø¬Ø¯Ø¯ Ø§Ø¬Ø±Ø§ Ù…ÛŒâ€ŒØ´ÙˆØ¯\n";
echo "   âœ… customerResult Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ù…ÛŒâ€ŒØ´ÙˆØ¯\n";

// Ø³Ù†Ø§Ø±ÛŒÙˆ 3: Ø®Ø·Ø§ Ø¯Ø± Ø§Ø³ØªØ¹Ù„Ø§Ù… Ø§ÙˆÙ„ÛŒÙ‡
echo "\n3. Ø³Ù†Ø§Ø±ÛŒÙˆ: Ø®Ø·Ø§ Ø¯Ø± Ø§Ø³ØªØ¹Ù„Ø§Ù… Ø§ÙˆÙ„ÛŒÙ‡\n";
echo "   âŒ GetCustomerByCode Ù†Ø§Ù…ÙˆÙÙ‚\n";
echo "   âœ… customerResult = null\n";
echo "   âœ… customerExists = false\n";
echo "   âž¡ï¸  ÙˆØ§Ø±Ø¯ ÙØ±Ø¢ÛŒÙ†Ø¯ Ø«Ø¨Øª Ù…Ø´ØªØ±ÛŒ Ù…ÛŒâ€ŒØ´ÙˆØ¯\n";
echo "   âœ… SaveCustomer Ø§Ø¬Ø±Ø§ Ù…ÛŒâ€ŒØ´ÙˆØ¯\n";
echo "   âœ… GetCustomerByCode Ù…Ø¬Ø¯Ø¯ Ø§Ø¬Ø±Ø§ Ù…ÛŒâ€ŒØ´ÙˆØ¯\n";

echo "\nðŸ” Ø¨Ø±Ø±Ø³ÛŒ Ú©Ø¯ ÙØ¹Ù„ÛŒ:\n";

$jobPath = __DIR__ . '/app/Jobs/ProcessInvoice.php';
if (file_exists($jobPath)) {
    $content = file_get_contents($jobPath);

    // Ø¨Ø±Ø±Ø³ÛŒ ÙˆØ¬ÙˆØ¯ Ù…Ù†Ø·Ù‚ Ø¯Ø±Ø³Øª Ø¨Ø±Ø§ÛŒ Ø®Ø·Ø§ Ø¯Ø± Ø§Ø³ØªØ¹Ù„Ø§Ù…
    $hasErrorHandling = strpos($content, 'Ø¨Ù‡ Ø¯Ù„ÛŒÙ„ Ø®Ø·Ø§ Ø¯Ø± Ø§Ø³ØªØ¹Ù„Ø§Ù…ØŒ Ø³Ø¹ÛŒ Ø¯Ø± Ø«Ø¨Øª Ù…Ø´ØªØ±ÛŒ Ù…ÛŒâ€ŒÚ©Ù†ÛŒÙ…') !== false;

    // Ø¨Ø±Ø±Ø³ÛŒ ÙˆØ¬ÙˆØ¯ Ø´Ø±Ø· Ø§ØµÙ„Ø§Ø­ Ø´Ø¯Ù‡
    $hasImprovedCondition = strpos($content, 'Ø§Ú¯Ø± Ù…Ø´ØªØ±ÛŒ ÙˆØ¬ÙˆØ¯ Ù†Ø¯Ø§Ø´Øª ÛŒØ§ Ø®Ø·Ø§ Ø¯Ø± Ø§Ø³ØªØ¹Ù„Ø§Ù… Ø±Ø® Ø¯Ø§Ø¯') !== false;

    // Ø¨Ø±Ø±Ø³ÛŒ ÙØ±Ø¢ÛŒÙ†Ø¯ Ø«Ø¨Øª Ù…Ø´ØªØ±ÛŒ
    $hasSaveCustomer = strpos($content, 'SaveCustomer') !== false;

    // Ø¨Ø±Ø±Ø³ÛŒ Ø§Ø³ØªØ¹Ù„Ø§Ù… Ù…Ø¬Ø¯Ø¯
    $hasRetryQuery = strpos($content, 'GetCustomerByCode_AfterSave') !== false;

    echo "   âœ… Ù…Ø¯ÛŒØ±ÛŒØª Ø®Ø·Ø§ Ø¯Ø± Ø§Ø³ØªØ¹Ù„Ø§Ù…: " . ($hasErrorHandling ? 'Ù…ÙˆØ¬ÙˆØ¯' : 'ØºÛŒØ±Ù…ÙˆØ¬ÙˆØ¯') . "\n";
    echo "   âœ… Ø´Ø±Ø· Ø¨Ù‡Ø¨ÙˆØ¯ ÛŒØ§ÙØªÙ‡: " . ($hasImprovedCondition ? 'Ù…ÙˆØ¬ÙˆØ¯' : 'ØºÛŒØ±Ù…ÙˆØ¬ÙˆØ¯') . "\n";
    echo "   âœ… ÙØ±Ø¢ÛŒÙ†Ø¯ Ø«Ø¨Øª Ù…Ø´ØªØ±ÛŒ: " . ($hasSaveCustomer ? 'Ù…ÙˆØ¬ÙˆØ¯' : 'ØºÛŒØ±Ù…ÙˆØ¬ÙˆØ¯') . "\n";
    echo "   âœ… Ø§Ø³ØªØ¹Ù„Ø§Ù… Ù…Ø¬Ø¯Ø¯: " . ($hasRetryQuery ? 'Ù…ÙˆØ¬ÙˆØ¯' : 'ØºÛŒØ±Ù…ÙˆØ¬ÙˆØ¯') . "\n";

    if ($hasErrorHandling && $hasImprovedCondition && $hasSaveCustomer && $hasRetryQuery) {
        echo "\nâœ… ÙØ±Ø¢ÛŒÙ†Ø¯ Ú©Ø§Ù…Ù„ Ù¾ÛŒØ§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ Ø´Ø¯Ù‡ Ø§Ø³Øª\n";
    } else {
        echo "\nâŒ ÙØ±Ø¢ÛŒÙ†Ø¯ Ú©Ø§Ù…Ù„ Ù¾ÛŒØ§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ Ù†Ø´Ø¯Ù‡ Ø§Ø³Øª\n";
    }
} else {
    echo "âŒ ÙØ§ÛŒÙ„ Job ÛŒØ§ÙØª Ù†Ø´Ø¯\n";
}

echo "\nðŸ“Š Ø¬Ø¯ÙˆÙ„ Ø¬Ø±ÛŒØ§Ù† ÙØ±Ø¢ÛŒÙ†Ø¯:\n";
echo "â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n";
echo "â”‚ Ø­Ø§Ù„Øª Ø§Ø³ØªØ¹Ù„Ø§Ù… Ø§ÙˆÙ„ÛŒÙ‡      â”‚ customerExists       â”‚ Ø§Ù‚Ø¯Ø§Ù… Ø¨Ø¹Ø¯ÛŒ             â”‚\n";
echo "â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\n";
echo "â”‚ Ù…ÙˆÙÙ‚ + CustomerID       â”‚ true                 â”‚ Ø§Ø¯Ø§Ù…Ù‡ Ø¨Ù‡ Ø«Ø¨Øª ÙØ§Ú©ØªÙˆØ±    â”‚\n";
echo "â”‚ Ù…ÙˆÙÙ‚ + null            â”‚ false                â”‚ Ø«Ø¨Øª Ù…Ø´ØªØ±ÛŒ + Ø§Ø³ØªØ¹Ù„Ø§Ù…    â”‚\n";
echo "â”‚ Ù†Ø§Ù…ÙˆÙÙ‚                 â”‚ false                â”‚ Ø«Ø¨Øª Ù…Ø´ØªØ±ÛŒ + Ø§Ø³ØªØ¹Ù„Ø§Ù…    â”‚\n";
echo "â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n";

echo "\nðŸŽ¯ Ø®Ù„Ø§ØµÙ‡ Ø¨Ù‡Ø¨ÙˆØ¯Ù‡Ø§:\n";
echo "âœ… Ù…Ø¯ÛŒØ±ÛŒØª Ø®Ø·Ø§ Ø¯Ø± Ø§Ø³ØªØ¹Ù„Ø§Ù… Ø§ÙˆÙ„ÛŒÙ‡ Ø§Ø¶Ø§ÙÙ‡ Ø´Ø¯\n";
echo "âœ… Ø­Ø§Ù„Øª 'Ù…Ø´ØªØ±ÛŒ ÛŒØ§ÙØª Ù†Ø´Ø¯' Ø¯Ø±Ø³Øª Ù¾Ø±Ø¯Ø§Ø²Ø´ Ù…ÛŒâ€ŒØ´ÙˆØ¯\n";
echo "âœ… ÙØ±Ø¢ÛŒÙ†Ø¯ Ø«Ø¨Øª Ù…Ø´ØªØ±ÛŒ Ø¯Ø± Ù‡Ø± Ø¯Ùˆ Ø­Ø§Ù„Øª Ø§Ø¬Ø±Ø§ Ù…ÛŒâ€ŒØ´ÙˆØ¯\n";
echo "âœ… Ø§Ø³ØªØ¹Ù„Ø§Ù… Ù…Ø¬Ø¯Ø¯ Ù¾Ø³ Ø§Ø² Ø«Ø¨Øª Ø§Ù†Ø¬Ø§Ù… Ù…ÛŒâ€ŒØ´ÙˆØ¯\n";
echo "âœ… Ù„Ø§Ú¯â€ŒÚ¯Ø°Ø§Ø±ÛŒ Ù…Ù†Ø§Ø³Ø¨ Ø¨Ø±Ø§ÛŒ ØªÙ…Ø§Ù… Ø­Ø§Ù„Ø§Øª\n";

?>
